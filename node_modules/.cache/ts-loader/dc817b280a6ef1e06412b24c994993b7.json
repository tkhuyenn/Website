{"remainingRequest":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\thread-loader\\dist\\cjs.js!D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\babel-loader\\lib\\index.js!D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\ts-loader\\index.js??ref--15-3!D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\eslint-loader\\index.js??ref--14-0!D:\\NEU\\CDTT\\frontend\\Website\\src\\mixins\\onchain.ts","dependencies":[{"path":"D:\\NEU\\CDTT\\frontend\\Website\\src\\mixins\\onchain.ts","mtime":1660970150807},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\babel.config.js","mtime":1660970148265},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660970364629},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1660970364258},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\babel-loader\\lib\\index.js","mtime":1660970387821},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\ts-loader\\index.js","mtime":1660970390648},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\eslint-loader\\index.js","mtime":1660970366946}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJEOlxcTkVVXFxDRFRUXFxmcm9udGVuZFxcV2Vic2l0ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcZGVmaW5lUHJvcGVydHkuanMiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICJEOlxcTkVVXFxDRFRUXFxmcm9udGVuZFxcV2Vic2l0ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcb2JqZWN0U3ByZWFkMi5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJEOlxcTkVVXFxDRFRUXFxmcm9udGVuZFxcV2Vic2l0ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcYXN5bmNUb0dlbmVyYXRvci5qcyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiRDpcXE5FVVxcQ0RUVFxcZnJvbnRlbmRcXFdlYnNpdGVcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXGNsYXNzQ2FsbENoZWNrLmpzIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJEOlxcTkVVXFxDRFRUXFxmcm9udGVuZFxcV2Vic2l0ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXGVzbVxcY3JlYXRlQ2xhc3MuanMiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkQ6XFxORVVcXENEVFRcXGZyb250ZW5kXFxXZWJzaXRlXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZVxcaGVscGVyc1xcZXNtXFxpbmhlcml0cy5qcyI7CmltcG9ydCBfY3JlYXRlU3VwZXIgZnJvbSAiRDpcXE5FVVxcQ0RUVFxcZnJvbnRlbmRcXFdlYnNpdGVcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXGNyZWF0ZVN1cGVyLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmcuanMiOwppbXBvcnQgeyBfX2RlY29yYXRlIH0gZnJvbSAidHNsaWIiOwppbXBvcnQgeyBDb21wb25lbnQsIE1peGlucyB9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InOwppbXBvcnQgUG9wdXBNaXhpbiBmcm9tICdAL21peGlucy9wb3B1cCc7CmltcG9ydCB7IG5hbWVzcGFjZSB9IGZyb20gJ3Z1ZXgtY2xhc3MnOwp2YXIgYmNBdXRoID0gbmFtZXNwYWNlKCdiZUF1dGgnKTsKdmFyIGJjTmZ0ID0gbmFtZXNwYWNlKCdiY05mdCcpOwp2YXIgYmVCYXNlID0gbmFtZXNwYWNlKCdiZUJhc2UnKTsKaW1wb3J0IGdldFJlcG9zaXRvcnkgZnJvbSAnQC9zZXJ2aWNlcy9pbmRleCc7CnZhciBhcGlOZnQgPSBnZXRSZXBvc2l0b3J5KCduZnQnKTsKdmFyIGFwaU5mdFYyID0gZ2V0UmVwb3NpdG9yeSgnbmZ0djInKTsKdmFyIGFwaU5mdFYzID0gZ2V0UmVwb3NpdG9yeSgnbmZ0djMnKTsKaW1wb3J0IE1vcmFsaXMgZnJvbSAnbW9yYWxpcyc7CmltcG9ydCBDb29raWVzIGZyb20gJ2pzLWNvb2tpZSc7CmltcG9ydCBmaWx0ZXIgZnJvbSAnbG9kYXNoL2ZpbHRlcic7CmltcG9ydCBpbmNsdWRlcyBmcm9tICdsb2Rhc2gvaW5jbHVkZXMnOwppbXBvcnQgV2FsbGV0Q29ubmVjdFByb3ZpZGVyIGZyb20gJ0B3YWxsZXRjb25uZWN0L3dlYjMtcHJvdmlkZXInOwppbXBvcnQgV2ViMyBmcm9tICd3ZWIzJzsKCnZhciBPbkNoYWluTWl4aW4gPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9NaXhpbnMpIHsKICBfaW5oZXJpdHMoT25DaGFpbk1peGluLCBfTWl4aW5zKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihPbkNoYWluTWl4aW4pOwoKICBmdW5jdGlvbiBPbkNoYWluTWl4aW4oKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE9uQ2hhaW5NaXhpbik7CgogICAgX3RoaXMgPSBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIF90aGlzLmFkZHJlc3MgPSAnJzsKICAgIF90aGlzLnJlZkFwcHJvdmVBY2NvdW50ID0gbnVsbDsKICAgIF90aGlzLmlzTG9hZGluZyA9IGZhbHNlOwogICAgX3RoaXMuaXNPcGVuUG9wdXAgPSBmYWxzZTsKICAgIF90aGlzLmlzQ2xpY2tDb25maXJtID0gZmFsc2U7CiAgICBfdGhpcy5jaGFpSWQgPSAnJzsKICAgIF90aGlzLmNoZWNrZWRBY2NlcHQgPSBmYWxzZTsKICAgIHJldHVybiBfdGhpczsKICB9IC8vdGVybSBjYWMgcG9wdXAKCgogIF9jcmVhdGVDbGFzcyhPbkNoYWluTWl4aW4sIFt7CiAgICBrZXk6ICJnZXRUZXJtIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICBpZiAodGhpcy5zeXN0ZW1QYXJhbXNQdWJsaWMubGVuZ3RoKSB7CiAgICAgICAgdmFyIHBhcmFtID0gZmlsdGVyKHRoaXMuc3lzdGVtUGFyYW1zUHVibGljLCBmdW5jdGlvbiAocGFyYW0pIHsKICAgICAgICAgIHJldHVybiBwYXJhbS5rZXkgPT09ICdzeXN0ZW0ubWFya2V0cGxhY2UudGVybXMuYW5kLmNvbmRpdGlvbnMnOwogICAgICAgIH0pOwogICAgICAgIHJldHVybiBwYXJhbVswXSAmJiBwYXJhbVswXS52YWx1ZSB8fCAnJzsKICAgICAgfQoKICAgICAgcmV0dXJuICcnOwogICAgfQogIH0sIHsKICAgIGtleTogImNvbnRyYWN0QWRkcmVzc0V4Y2hhbmdlIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5pc0xvZ2luKSB7CiAgICAgICAgdmFyIGNvbnRyYWN0ID0gZmlsdGVyKHRoaXMubGlzdE5mdEFzc2V0T25DaGFpbiwgZnVuY3Rpb24gKGVsbSkgewogICAgICAgICAgcmV0dXJuIGVsbS50eXBlID09PSAnRVhDSEFOR0UnICYmIGVsbS5pc1N5c3RlbSAmJiBlbG0uYmFzZUN1cnJlbmN5ID09PSBfdGhpczIubmZ0SXRlbS5iYXNlQ3VycmVuY3k7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGNvbnRyYWN0Lmxlbmd0aCA/IGNvbnRyYWN0WzBdLmNvbnRyYWN0QWRkcmVzcyA6ICcnOwogICAgICB9CgogICAgICByZXR1cm4gJyc7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0QWJpQ29kZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldEFiaUNvZGUgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoY3VycmVuY3ksIGFkZHJlc3NDb250cmFjdCkgewogICAgICAgIHZhciB0eXBlLCBjb250cmFjdEFkZHJlc3MsIHJlc3VsdEFiaSwgYWJpOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAwOwogICAgICAgICAgICAgICAgdHlwZSA9IGluY2x1ZGVzKFsnVVNEQycsICdVU0RUJywgJ0NMTScsICdMWU5LJywgJ0VUSCddLCBjdXJyZW5jeSkgPyAnRVRIJyA6ICdCTkInOwogICAgICAgICAgICAgICAgY29udHJhY3RBZGRyZXNzID0gYWRkcmVzc0NvbnRyYWN0ID8gYWRkcmVzc0NvbnRyYWN0IDogdGhpcy5nZXRDb250cmFjdEFkZHJlc3NUb0dldEFiaUNvZGUoY3VycmVuY3kpOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU7CiAgICAgICAgICAgICAgICByZXR1cm4gYXBpTmZ0LmdldEFiaUNvbnRyYWN0KHsKICAgICAgICAgICAgICAgICAgbW9kdWxlOiAnY29udHJhY3QnLAogICAgICAgICAgICAgICAgICBhY3Rpb246ICdnZXRhYmknLAogICAgICAgICAgICAgICAgICBhZGRyZXNzOiBjb250cmFjdEFkZHJlc3MsCiAgICAgICAgICAgICAgICAgIGFwaWtleTogJ0IxN1ZCTkJEQTRFTVVVVDYzSkI1SFQ5NzZXVVNDOFM1NUInCiAgICAgICAgICAgICAgICB9LCB0eXBlKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcmVzdWx0QWJpID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIGFiaSA9IEpTT04ucGFyc2UocmVzdWx0QWJpKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIFByb21pc2UucmVzb2x2ZShhYmkpKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMDsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMCk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLnJlamVjdChfY29udGV4dC50MCkpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcywgW1swLCAxMF1dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0QWJpQ29kZShfeCwgX3gyKSB7CiAgICAgICAgcmV0dXJuIF9nZXRBYmlDb2RlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRBYmlDb2RlOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiZ2V0QmFsYW5jZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldEJhbGFuY2UgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKGNvbnRyYWN0QWRkcmVzcywgY3VycmVuY3kpIHsKICAgICAgICB2YXIgbmV0d29ya05hbWUsIF9vcHRpb25zLCBiYWxhbmNlLCBvcHRpb25zLCByZXN1bHRBbGwsIHRva2VuLCBtZXNzYWdlOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAwOwogICAgICAgICAgICAgICAgbmV0d29ya05hbWUgPSBpbmNsdWRlcyhbJ1VTREMnLCAnVVNEVCcsICdDTE0nLCAnTFlOSycsICdFVEgnXSwgY3VycmVuY3kpID8gcHJvY2Vzcy5lbnYuVlVFX0FQUF9ORVRXT1JLX05BTUVfRVRIIDogcHJvY2Vzcy5lbnYuVlVFX0FQUF9ORVRXT1JLX05BTUVfQk5COwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIE1vcmFsaXMuZW5hYmxlV2ViMygpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBpZiAoIShjdXJyZW5jeSA9PT0gJ0VUSCcgfHwgY3VycmVuY3kgPT09ICdCTkInKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfb3B0aW9ucyA9IHsKICAgICAgICAgICAgICAgICAgY2hhaW46IG5ldHdvcmtOYW1lLAogICAgICAgICAgICAgICAgICBhZGRyZXNzOiB0aGlzLndhbGxldEFkZHJlc3MKICAgICAgICAgICAgICAgIH07IC8vQHRzLWlnbm9yZQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gODsKICAgICAgICAgICAgICAgIHJldHVybiBNb3JhbGlzLldlYjNBUEkuYWNjb3VudC5nZXROYXRpdmVCYWxhbmNlKF9vcHRpb25zKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgYmFsYW5jZSA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIFByb21pc2UucmVzb2x2ZShOdW1iZXIoTW9yYWxpcy5Vbml0cy5Gcm9tV2VpKGJhbGFuY2UuYmFsYW5jZSkpKSk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICBvcHRpb25zID0gewogICAgICAgICAgICAgICAgICBjaGFpbjogbmV0d29ya05hbWUsCiAgICAgICAgICAgICAgICAgIGFkZHJlc3M6IHRoaXMud2FsbGV0QWRkcmVzcwogICAgICAgICAgICAgICAgfTsgLy9AdHMtaWdub3JlCgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxMzsKICAgICAgICAgICAgICAgIHJldHVybiBNb3JhbGlzLldlYjNBUEkuYWNjb3VudC5nZXRUb2tlbkJhbGFuY2VzKG9wdGlvbnMpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgcmVzdWx0QWxsID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICB0b2tlbiA9IGZpbHRlcihyZXN1bHRBbGwsIGZ1bmN0aW9uIChlbG0pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsbS50b2tlbl9hZGRyZXNzID09PSBjb250cmFjdEFkZHJlc3MudG9Mb3dlckNhc2UoKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGlmICghdG9rZW4ubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLnJlc29sdmUoTnVtYmVyKHRva2VuWzBdLmJhbGFuY2UpIC8gTWF0aC5wb3coMTAsIE51bWJlcih0b2tlblswXS5kZWNpbWFscykpKSk7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgUHJvbWlzZS5yZXNvbHZlKDApKTsKCiAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMjA7CiAgICAgICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMCk7CgogICAgICAgICAgICAgICAgaWYgKF9jb250ZXh0Mi50MC5tZXNzYWdlID09PSAnTm9uIGV0aGVyZXVtIGVuYWJsZWQgYnJvd3NlcicpIHsKICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IHRoaXMuJHQoJ25vdGlmeS5pbnN0YWxsLW1ldGFtYXNrJyk7CiAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDUwMDAKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIFByb21pc2UucmVqZWN0KF9jb250ZXh0Mi50MCkpOwoKICAgICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyLCB0aGlzLCBbWzAsIDIwXV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRCYWxhbmNlKF94MywgX3g0KSB7CiAgICAgICAgcmV0dXJuIF9nZXRCYWxhbmNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRCYWxhbmNlOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiYWN0aW9uV2hlbkxvZ2dlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2FjdGlvbldoZW5Mb2dnZWQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKGl0ZW1OZnQsIGNvbnRyYWN0QWRkcmVzcywgdHlwZSwgb3duZXJJZCkgewogICAgICAgIHZhciBpc0V4aXRzVG9rZW4sIGJhbGFuY2UsIHBhcmFtcywgaW5mb0FjdGl2aXR5LCBtZXNzYWdlOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpc0V4aXRzVG9rZW4gPSBDb29raWVzLmdldCgnYWNjZXNzX3Rva2VuJykgfHwgJyc7IC8vbeG6oW5nIHJvcHN0ZW4KICAgICAgICAgICAgICAgIC8vIGlmICghaXNFeGl0c1Rva2VuKSB7CiAgICAgICAgICAgICAgICAvLyAgIGF3YWl0IHRoaXMuaGFuZGxlTG9naW5FeHRlcm5hbCgpCiAgICAgICAgICAgICAgICAvLyB9CgogICAgICAgICAgICAgICAgYmFsYW5jZSA9IDA7CgogICAgICAgICAgICAgICAgaWYgKCEodHlwZSA9PT0gJ2J1eScpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmFsYW5jZSh0aGlzLmdldENvbnRyYWN0QWRkcmVzc09mQ3VycmVuY3kodGhpcy5jdXJyZW5jeVNlbGVjdEJ1eSksIHRoaXMuY3VycmVuY3lTZWxlY3RCdXkpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBiYWxhbmNlID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDExOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRCYWxhbmNlKHRoaXMuZ2V0Q29udHJhY3RBZGRyZXNzT2ZDdXJyZW5jeSh0aGlzLnRva2VuTmVlZEdldEJhbGFuY2UpLCB0aGlzLnRva2VuTmVlZEdldEJhbGFuY2UpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgYmFsYW5jZSA9IF9jb250ZXh0My5zZW50OwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgcGFyYW1zID0gewogICAgICAgICAgICAgICAgICBsaXN0aW5nSWQ6IGl0ZW1OZnQgPT09IG51bGwgfHwgaXRlbU5mdCA9PT0gdm9pZCAwID8gdm9pZCAwIDogaXRlbU5mdC5taW5MaXN0aW5nSWQsCiAgICAgICAgICAgICAgICAgIGl0ZW1JZDogdHlwZSA9PT0gJ29mZmVyJyA/IGl0ZW1OZnQuaWQgOiBudWxsLAogICAgICAgICAgICAgICAgICBvd25lcklkOiB0eXBlID09PSAnb2ZmZXInID8gb3duZXJJZCA6IG51bGwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgcmV0dXJuIGFwaU5mdC5nZXRMeW5rZXlJbmZvKGl0ZW1OZnQuY3VycmVuY3ksIHBhcmFtcyk7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBpbmZvQWN0aXZpdHkgPSBfY29udGV4dDMuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoISh0eXBlICE9PSAnYnV5JyAmJiB0aGlzLiRyb3V0ZS5uYW1lICE9PSAnRGV0YWlsTmZ0SXRlbScgJiYgaW5mb0FjdGl2aXR5Lm15T2ZmZXJTdGF0dXMgIT09ICdTVUNDRVNTJyAmJiBpbmZvQWN0aXZpdHkubXlPZmZlclN0YXR1cyAhPT0gJ0ZBSUxFRCcgJiYgaW5mb0FjdGl2aXR5Lm15T2ZmZXJTdGF0dXMgIT09IG51bGwpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBpdGVtTmZ0Lml0ZW1OYW1lICsgJyAnICsgdGhpcy4kdCgnbm90aWZ5LnRyYW5zYWN0aW9uLWlzLXBlbmRpbmcnKTsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoewogICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLAogICAgICAgICAgICAgICAgICBkdXJhdGlvbjogNTAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0SW5mb0FjdGl2aXR5KF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgaW5mb0FjdGl2aXR5KSwge30sIHsKICAgICAgICAgICAgICAgICAgYXZhaWxhYmxlOiBiYWxhbmNlCiAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2J1eScpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5zZXRPcGVuUG9wdXAoewogICAgICAgICAgICAgICAgICAgIHBvcHVwTmFtZTogJ3BvcHVwLWJ1eS1uZnQnLAogICAgICAgICAgICAgICAgICAgIGlzT3BlbjogdHJ1ZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2JpZCcpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5zZXRPcGVuUG9wdXAoewogICAgICAgICAgICAgICAgICAgIHBvcHVwTmFtZTogJ3BvcHVwLXBsYWNlLWJpZCcsCiAgICAgICAgICAgICAgICAgICAgaXNPcGVuOiB0cnVlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnb2ZmZXInKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuc2V0T3BlblBvcHVwKHsKICAgICAgICAgICAgICAgICAgICBwb3B1cE5hbWU6ICdwb3B1cC1tYWtlLW9mZmVyJywKICAgICAgICAgICAgICAgICAgICBpc09wZW46IHRydWUKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBhY3Rpb25XaGVuTG9nZ2VkKF94NSwgX3g2LCBfeDcsIF94OCkgewogICAgICAgIHJldHVybiBfYWN0aW9uV2hlbkxvZ2dlZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gYWN0aW9uV2hlbkxvZ2dlZDsKICAgIH0oKSAvLyBhc3luYyBoYW5kbGVMb2dpbkV4dGVybmFsKCk6IFByb21pc2U8dm9pZD4gewogICAgLy8gICB0cnkgewogICAgLy8gICAgIGNvbnN0IEtFWSA9IHByb2Nlc3MuZW52LlZVRV9BUFBfS0VZX0VYVEVSTkFMCiAgICAvLyAgICAgY29uc3QgY3JlZGVudGlhbCA9IHRoaXMuJG9wdGlvbnMuZmlsdGVycz8uZW5jcnlwdFBhc3N3b3JkKG1kNSh0aGlzLmFkZHJlc3MgKyBLRVkpKQogICAgLy8gICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFwaU5mdC5leHRlcm5hbExvZ2luKHsKICAgIC8vICAgICAgIHdhbGxldFR5cGU6ICdNRVRBTUFTSycsCiAgICAvLyAgICAgICBhZGRyZXNzOiB0aGlzLmFkZHJlc3MsCiAgICAvLyAgICAgICBjcmVkZW50aWFsCiAgICAvLyAgICAgfSkKICAgIC8vICAgICB0aGlzLnNldFRva2VuRXh0ZXJuYWxMb2dpbihyZXN1bHQpCiAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpCiAgICAvLyAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCkKICAgIC8vICAgfQogICAgLy8gfQoKICB9LCB7CiAgICBrZXk6ICJnZXRDb250cmFjdEFkZHJlc3NUb0dldEFiaUNvZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbnRyYWN0QWRkcmVzc1RvR2V0QWJpQ29kZShjdXJyZW5jeSkgewogICAgICBpZiAodGhpcy5saXN0QXNzZXROZXR3b3JrLmxlbmd0aCkgewogICAgICAgIHZhciB0b2tlbiA9IGZpbHRlcih0aGlzLmxpc3RBc3NldE5ldHdvcmssIGZ1bmN0aW9uICh0b2tlbikgewogICAgICAgICAgcmV0dXJuIHRva2VuLmN1cnJlbmN5ID09PSBjdXJyZW5jeTsKICAgICAgICB9KVswXTsKCiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0b2tlbiwgJ2ltcGxlbWVudEFkZHJlc3MnKSkgewogICAgICAgICAgcmV0dXJuIHRva2VuLmltcGxlbWVudEFkZHJlc3M7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gKHRva2VuID09PSBudWxsIHx8IHRva2VuID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0b2tlbi5jb250cmFjdEFkZHJlc3MpIHx8ICcnOwogICAgICB9CgogICAgICByZXR1cm4gJyc7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0Q29udHJhY3RBZGRyZXNzT2ZDdXJyZW5jeSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29udHJhY3RBZGRyZXNzT2ZDdXJyZW5jeShjdXJyZW5jeSkgewogICAgICBpZiAodGhpcy5saXN0QXNzZXROZXR3b3JrLmxlbmd0aCkgewogICAgICAgIHZhciB0b2tlbiA9IGZpbHRlcih0aGlzLmxpc3RBc3NldE5ldHdvcmssIGZ1bmN0aW9uICh0b2tlbikgewogICAgICAgICAgcmV0dXJuIHRva2VuLmN1cnJlbmN5ID09PSBjdXJyZW5jeTsKICAgICAgICB9KVswXTsKICAgICAgICByZXR1cm4gKHRva2VuID09PSBudWxsIHx8IHRva2VuID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0b2tlbi5jb250cmFjdEFkZHJlc3MpIHx8ICcnOwogICAgICB9CgogICAgICByZXR1cm4gJyc7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0QWxsb3dhbmNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0QWxsb3dhbmNlID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChvd25lckFkZHJlc3MsIGN1cnJlbmN5KSB7CiAgICAgICAgdmFyIF9wYXJhbXMsIF90aGlzJCRvcHRpb25zJGZpbHRlciwgY29udHJhY3RBZGRyZXNzLCBhYmksIGZ1bmN0aW9uQWxsb3dhbmNlLCBuYW1lUGFyYW1zT3duZXIsIG5hbWVQYXJhbXNTcGVuZGVyLCBwYXJhbXMsIHJlYWRPcHRpb25zLCBhbGxvd2FuY2UsIGRlY2ltYWwsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDQucHJldiA9IDA7CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gTW9yYWxpcy5lbmFibGVXZWIzKCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIGNvbnRyYWN0QWRkcmVzcyA9IHRoaXMuZ2V0Q29udHJhY3RBZGRyZXNzT2ZDdXJyZW5jeShjdXJyZW5jeSk7CiAgICAgICAgICAgICAgICBhYmkgPSBbXTsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEFiaUNvZGUoY3VycmVuY3kpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBhYmkgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgIGZ1bmN0aW9uQWxsb3dhbmNlID0gZmlsdGVyKGFiaSwgZnVuY3Rpb24gKGVsbSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZWxtLm5hbWUgPT09ICdhbGxvd2FuY2UnOwogICAgICAgICAgICAgICAgfSlbMF07CiAgICAgICAgICAgICAgICBuYW1lUGFyYW1zT3duZXIgPSBmdW5jdGlvbkFsbG93YW5jZS5pbnB1dHNbMF0ubmFtZTsKICAgICAgICAgICAgICAgIG5hbWVQYXJhbXNTcGVuZGVyID0gZnVuY3Rpb25BbGxvd2FuY2UuaW5wdXRzWzFdLm5hbWU7CiAgICAgICAgICAgICAgICBwYXJhbXMgPSAoX3BhcmFtcyA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX3BhcmFtcywgbmFtZVBhcmFtc093bmVyLCBvd25lckFkZHJlc3MpLCBfZGVmaW5lUHJvcGVydHkoX3BhcmFtcywgbmFtZVBhcmFtc1NwZW5kZXIsIHRoaXMuY29udHJhY3RBZGRyZXNzRXhjaGFuZ2UpLCBfcGFyYW1zKTsKICAgICAgICAgICAgICAgIHJlYWRPcHRpb25zID0gewogICAgICAgICAgICAgICAgICBjb250cmFjdEFkZHJlc3M6IGNvbnRyYWN0QWRkcmVzcywKICAgICAgICAgICAgICAgICAgZnVuY3Rpb25OYW1lOiAnYWxsb3dhbmNlJywKICAgICAgICAgICAgICAgICAgYWJpOiBhYmksCiAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgIHJldHVybiBNb3JhbGlzLmV4ZWN1dGVGdW5jdGlvbihyZWFkT3B0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICBhbGxvd2FuY2UgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgIGRlY2ltYWwgPSAoX3RoaXMkJG9wdGlvbnMkZmlsdGVyID0gdGhpcy4kb3B0aW9ucy5maWx0ZXJzKSA9PT0gbnVsbCB8fCBfdGhpcyQkb3B0aW9ucyRmaWx0ZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJCRvcHRpb25zJGZpbHRlci5nZXREZWNpbWFsc1Rva2VuKGN1cnJlbmN5KTsKICAgICAgICAgICAgICAgIGRhdGEgPSB7CiAgICAgICAgICAgICAgICAgIGFsbG93YW5jZTogcGFyc2VJbnQoYWxsb3dhbmNlWydfaGV4J10sIDE2KSAvIE1hdGgucG93KDEwLCBkZWNpbWFsKSwKICAgICAgICAgICAgICAgICAgYWJpOiBhYmkKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgZGF0YSk7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICBfY29udGV4dDQucHJldiA9IDIxOwogICAgICAgICAgICAgICAgX2NvbnRleHQ0LnQwID0gX2NvbnRleHQ0WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIFByb21pc2UucmVqZWN0KF9jb250ZXh0NC50MCkpOwoKICAgICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0LCB0aGlzLCBbWzAsIDIxXV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRBbGxvd2FuY2UoX3g5LCBfeDEwKSB7CiAgICAgICAgcmV0dXJuIF9nZXRBbGxvd2FuY2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldEFsbG93YW5jZTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogInNldEFwcHJvdmFsRm9yQWxsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfc2V0QXBwcm92YWxGb3JBbGwgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KGNvbnRyYWN0QWRkcmVzcywgc3BlbmRlcldhbGxldCwgY3VycmVuY3kpIHsKICAgICAgICB2YXIgYWJpLCBwYXJhbXMsIHJlYWRPcHRpb25zLCB0cmFuc2FjdGlvbjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTUkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ1LnByZXYgPSAwOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIE1vcmFsaXMuZW5hYmxlV2ViMygpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2V0QXBwcm92YWxGb3JBbGwnKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gNjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEFiaUNvZGUoY3VycmVuY3ksIGNvbnRyYWN0QWRkcmVzcyk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIGFiaSA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYWJpKTsKICAgICAgICAgICAgICAgIHBhcmFtcyA9IHsKICAgICAgICAgICAgICAgICAgb3BlcmF0b3JzOiBbc3BlbmRlcldhbGxldCwgdGhpcy5jb250cmFjdEFkZHJlc3NFeGNoYW5nZV0sCiAgICAgICAgICAgICAgICAgIGFwcHJvdmVkOiB0cnVlCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgcmVhZE9wdGlvbnMgPSB7CiAgICAgICAgICAgICAgICAgIGNvbnRyYWN0QWRkcmVzczogY29udHJhY3RBZGRyZXNzLAogICAgICAgICAgICAgICAgICBmdW5jdGlvbk5hbWU6ICdzZXRCYXRjaEFwcHJvdmFsRm9yQWxsJywKICAgICAgICAgICAgICAgICAgYWJpOiBhYmksCiAgICAgICAgICAgICAgICAgIHBhcmFtczogcGFyYW1zCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhZE9wdGlvbnMpOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgIHJldHVybiBNb3JhbGlzLmV4ZWN1dGVGdW5jdGlvbihyZWFkT3B0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbiA9IF9jb250ZXh0NS5zZW50OwogICAgICAgICAgICAgICAgdGhpcy5pc0NsaWNrQ29uZmlybSA9IHRydWU7CiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXR1c0FscmVhZHlBcHByb3ZlKHRydWUpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIFByb21pc2UucmVzb2x2ZSh0cmFuc2FjdGlvbikpOwoKICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgICAgX2NvbnRleHQ1LnByZXYgPSAxOTsKICAgICAgICAgICAgICAgIF9jb250ZXh0NS50MCA9IF9jb250ZXh0NVsiY2F0Y2giXSgwKTsKICAgICAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhfY29udGV4dDUudDApOwoKICAgICAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1LCB0aGlzLCBbWzAsIDE5XV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBzZXRBcHByb3ZhbEZvckFsbChfeDExLCBfeDEyLCBfeDEzKSB7CiAgICAgICAgcmV0dXJuIF9zZXRBcHByb3ZhbEZvckFsbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gc2V0QXBwcm92YWxGb3JBbGw7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJwdXRPblNhbGVPbkNoYWluIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcHV0T25TYWxlT25DaGFpbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoYm9keSwgY29udHJhY3RBZGRyZXNzLCBzcGVuZGVyV2FsbGV0LCBwb3B1cE5hbWUsIGN1cnJlbmN5KSB7CiAgICAgICAgdmFyIHRyYW5zYWN0aW9uLCBlbWl0VmFsdWU7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU2JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gMDsKCiAgICAgICAgICAgICAgICBpZiAoISh0aGlzLnN0YXR1c0FwcHJvdmVBY2NvdW50ID09PSAnTk9ORScgfHwgdGhpcy5zdGF0dXNBcHByb3ZlQWNjb3VudCA9PT0gJ0ZBSUxFRCcpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2V0QXBwcm92YWxGb3JBbGwoY29udHJhY3RBZGRyZXNzLCBzcGVuZGVyV2FsbGV0LCBjdXJyZW5jeSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDc7CiAgICAgICAgICAgICAgICByZXR1cm4gYXBpTmZ0LnZhbGlkYXRlQXBwcm92ZSh7fSwgewogICAgICAgICAgICAgICAgICBoYXNoOiB0cmFuc2FjdGlvbi5oYXNoLAogICAgICAgICAgICAgICAgICBpdGVtSWQ6IGJvZHkuaXRlbUlkCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgaWYgKCEodGhpcy5zdGF0dXNBcHByb3ZlQWNjb3VudCA9PT0gJ1NVQ0NFU1MnKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgcmV0dXJuIGFwaU5mdFYzLmZpeGVkUHJpY2UoYm9keSk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy5zZXRPcGVuUG9wdXAoewogICAgICAgICAgICAgICAgICBwb3B1cE5hbWU6IHBvcHVwTmFtZSwKICAgICAgICAgICAgICAgICAgaXNPcGVuOiBmYWxzZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBlbWl0VmFsdWUgPSBwb3B1cE5hbWUgPT09ICdwb3B1cC1maXhlZC1wcmljZScgPyAncHV0LWZpeGVkJyA6IHBvcHVwTmFtZSA9PT0gJ3BvcHVwLW9wZW4tZm9yLWJpZHMnID8gJ3B1dC1vcGVuJyA6ICdwdXQtdGltZSc7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdzdWNjZXNzJywgZW1pdFZhbHVlKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLnJlc29sdmUoKSk7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDE3OwogICAgICAgICAgICAgICAgX2NvbnRleHQ2LnQwID0gX2NvbnRleHQ2WyJjYXRjaCJdKDApOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coX2NvbnRleHQ2LnQwKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLnJlamVjdChfY29udGV4dDYudDApKTsKCiAgICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNiwgdGhpcywgW1swLCAxN11dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcHV0T25TYWxlT25DaGFpbihfeDE0LCBfeDE1LCBfeDE2LCBfeDE3LCBfeDE4KSB7CiAgICAgICAgcmV0dXJuIF9wdXRPblNhbGVPbkNoYWluLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwdXRPblNhbGVPbkNoYWluOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiYWNjZXB0T2ZmZXJPbmNoYWluIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfYWNjZXB0T2ZmZXJPbmNoYWluID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNyhib2R5LCBjb250cmFjdEFkZHJlc3MsIHNwZW5kZXJXYWxsZXQsIHBvcHVwTmFtZSwgY3VycmVuY3ksIGl0ZW1JZCkgewogICAgICAgIHZhciB0cmFuc2FjdGlvbjsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ3LnByZXYgPSAwOwoKICAgICAgICAgICAgICAgIGlmICghKHRoaXMuc3RhdHVzQXBwcm92ZUFjY291bnQgPT09ICdOT05FJyB8fCB0aGlzLnN0YXR1c0FwcHJvdmVBY2NvdW50ID09PSAnRkFJTEVEJykpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zZXRBcHByb3ZhbEZvckFsbChjb250cmFjdEFkZHJlc3MsIHNwZW5kZXJXYWxsZXQsIGN1cnJlbmN5KTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24gPSBfY29udGV4dDcuc2VudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiBhcGlOZnQudmFsaWRhdGVBcHByb3ZlKHt9LCB7CiAgICAgICAgICAgICAgICAgIGhhc2g6IHRyYW5zYWN0aW9uLmhhc2gsCiAgICAgICAgICAgICAgICAgIGl0ZW1JZDogaXRlbUlkCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgaWYgKCEodGhpcy5zdGF0dXNBcHByb3ZlQWNjb3VudCA9PT0gJ1NVQ0NFU1MnKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgcmV0dXJuIGFwaU5mdFYzLnBvc3RBY2NlcHRPZmZlcihib2R5KTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLnNldE9wZW5Qb3B1cCh7CiAgICAgICAgICAgICAgICAgIHBvcHVwTmFtZTogcG9wdXBOYW1lLAogICAgICAgICAgICAgICAgICBpc09wZW46IGZhbHNlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRoaXMuc2V0VHlwZU9mQWN0aW9uKCdvZmZlci1hY2NlcHQnKTsKICAgICAgICAgICAgICAgIHRoaXMuc2V0T3BlblBvcHVwKHsKICAgICAgICAgICAgICAgICAgcG9wdXBOYW1lOiAncG9wdXAtbm90aWZ5LXN1Y2Nlc3MnLAogICAgICAgICAgICAgICAgICBpc09wZW46IHRydWUKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxOTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgICAgX2NvbnRleHQ3LnByZXYgPSAxNjsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny50MCA9IF9jb250ZXh0N1siY2F0Y2giXSgwKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLnJlamVjdChfY29udGV4dDcudDApKTsKCiAgICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNywgdGhpcywgW1swLCAxNl1dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gYWNjZXB0T2ZmZXJPbmNoYWluKF94MTksIF94MjAsIF94MjEsIF94MjIsIF94MjMsIF94MjQpIHsKICAgICAgICByZXR1cm4gX2FjY2VwdE9mZmVyT25jaGFpbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gYWNjZXB0T2ZmZXJPbmNoYWluOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiYXBwcm92ZUV4Y2hhbmdlU3BlbmRUb2tlbk9mVXNlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2FwcHJvdmVFeGNoYW5nZVNwZW5kVG9rZW5PZlVzZXIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KGN1cnJlbmN5LCBvbGRBbW91bnQsIGFtb3VudCwgdHlwZSkgewogICAgICAgIHZhciBfdGhpcyQkb3B0aW9ucyRmaWx0ZXIyLCBfcGFyYW1zMiwgcmVzdWx0LCBhbGxvd2FuY2UsIGFiaSwgZGVjaW1hbCwgZnVuY3Rpb25BcHByb3ZlLCBuYW1lUGFyYW1zU3BlbmRlciwgbmFtZVBhcmFtc0Ftb3VudCwgcGFyYW1zLCBjb250cmFjdEFkZHJlc3MsIHdyaXRlT3B0aW9ucywgdHJhbnNhY3Rpb247CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOCQoX2NvbnRleHQ4KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OC5wcmV2ID0gX2NvbnRleHQ4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDgucHJldiA9IDA7CiAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRBbGxvd2FuY2UodGhpcy53YWxsZXRBZGRyZXNzLCBjdXJyZW5jeSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9jb250ZXh0OC5zZW50OwogICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdAogICAgICAgICAgICAgICAgYWxsb3dhbmNlID0gcmVzdWx0LmFsbG93YW5jZSwgYWJpID0gcmVzdWx0LmFiaTsKCiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2JpZC1hZGQnIHx8IHR5cGUgPT09ICdvZmZlci1tYWtlJykgewogICAgICAgICAgICAgICAgICBhbGxvd2FuY2UgKz0gYW1vdW50OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnYmlkLWVkaXQnIHx8IHR5cGUgPT09ICdvZmZlci1lZGl0JykgewogICAgICAgICAgICAgICAgICBhbGxvd2FuY2UgPSBhbGxvd2FuY2UgLSBvbGRBbW91bnQgKyBhbW91bnQ7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdiaWQtY2FuY2VsJyB8fCB0eXBlID09PSAnb2ZmZXItY2FuY2VsJykgewogICAgICAgICAgICAgICAgICBhbGxvd2FuY2UgLT0gYW1vdW50OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhbGxvd2FuY2UnLCBhbGxvd2FuY2UpOwogICAgICAgICAgICAgICAgZGVjaW1hbCA9IChfdGhpcyQkb3B0aW9ucyRmaWx0ZXIyID0gdGhpcy4kb3B0aW9ucy5maWx0ZXJzKSA9PT0gbnVsbCB8fCBfdGhpcyQkb3B0aW9ucyRmaWx0ZXIyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyQkb3B0aW9ucyRmaWx0ZXIyLmdldERlY2ltYWxzVG9rZW4oY3VycmVuY3kpOwogICAgICAgICAgICAgICAgZnVuY3Rpb25BcHByb3ZlID0gZmlsdGVyKGFiaSwgZnVuY3Rpb24gKGVsbSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gZWxtLm5hbWUgPT09ICdhcHByb3ZlJzsKICAgICAgICAgICAgICAgIH0pWzBdOwogICAgICAgICAgICAgICAgbmFtZVBhcmFtc1NwZW5kZXIgPSBmdW5jdGlvbkFwcHJvdmUuaW5wdXRzWzBdLm5hbWU7CiAgICAgICAgICAgICAgICBuYW1lUGFyYW1zQW1vdW50ID0gZnVuY3Rpb25BcHByb3ZlLmlucHV0c1sxXS5uYW1lOwogICAgICAgICAgICAgICAgcGFyYW1zID0gKF9wYXJhbXMyID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfcGFyYW1zMiwgbmFtZVBhcmFtc1NwZW5kZXIsIHRoaXMuY29udHJhY3RBZGRyZXNzRXhjaGFuZ2UpLCBfZGVmaW5lUHJvcGVydHkoX3BhcmFtczIsIG5hbWVQYXJhbXNBbW91bnQsIGN1cnJlbmN5ID09PSAnQk5CJyB8fCBjdXJyZW5jeSA9PT0gJ0JVU0QnID8gTWF0aC5mbG9vcihhbGxvd2FuY2UgKiBNYXRoLnBvdygxMCwgZGVjaW1hbCArIDEpIC8gMTApLnRvU3RyaW5nKCkgOiBNYXRoLmZsb29yKGFsbG93YW5jZSAqIE1hdGgucG93KDEwLCBkZWNpbWFsICsgMSkgLyAxMCkpLCBfcGFyYW1zMik7CiAgICAgICAgICAgICAgICBjb250cmFjdEFkZHJlc3MgPSB0aGlzLmdldENvbnRyYWN0QWRkcmVzc09mQ3VycmVuY3koY3VycmVuY3kpOwogICAgICAgICAgICAgICAgd3JpdGVPcHRpb25zID0gewogICAgICAgICAgICAgICAgICBjb250cmFjdEFkZHJlc3M6IGNvbnRyYWN0QWRkcmVzcywKICAgICAgICAgICAgICAgICAgZnVuY3Rpb25OYW1lOiAnYXBwcm92ZScsCiAgICAgICAgICAgICAgICAgIGFiaTogYWJpLAogICAgICAgICAgICAgICAgICBwYXJhbXM6IHBhcmFtcwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd3cml0ZU9wdGlvbnMnLCB3cml0ZU9wdGlvbnMpOwogICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAxOTsKICAgICAgICAgICAgICAgIHJldHVybiBNb3JhbGlzLmV4ZWN1dGVGdW5jdGlvbih3cml0ZU9wdGlvbnMpOwoKICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24gPSBfY29udGV4dDguc2VudDsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRyYW5zYWN0aW9uKTsKICAgICAgICAgICAgICAgIHRoaXMuc2V0VHJhbnNhY3Rpb25Db2RlSXRlbSh0cmFuc2FjdGlvbi5oYXNoKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLnJlc29sdmUodHJhbnNhY3Rpb24uaGFzaCkpOwoKICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgICAgX2NvbnRleHQ4LnByZXYgPSAyNTsKICAgICAgICAgICAgICAgIF9jb250ZXh0OC50MCA9IF9jb250ZXh0OFsiY2F0Y2giXSgwKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLnJlamVjdChfY29udGV4dDgudDApKTsKCiAgICAgICAgICAgICAgY2FzZSAyODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOCwgdGhpcywgW1swLCAyNV1dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gYXBwcm92ZUV4Y2hhbmdlU3BlbmRUb2tlbk9mVXNlcihfeDI1LCBfeDI2LCBfeDI3LCBfeDI4KSB7CiAgICAgICAgcmV0dXJuIF9hcHByb3ZlRXhjaGFuZ2VTcGVuZFRva2VuT2ZVc2VyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBhcHByb3ZlRXhjaGFuZ2VTcGVuZFRva2VuT2ZVc2VyOwogICAgfSgpCiAgfSwgewogICAga2V5OiAic3dpdGNoTmV0d29yayIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3N3aXRjaE5ldHdvcmsgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU5KGJhc2VDdXJyZW5jeSkgewogICAgICAgIHZhciBjaGFpbklkTmV0V29yaywgbmV0d29ya05hbWUsIG1lc3NhZ2UsIF9uZXR3b3JrTmFtZSwgX21lc3NhZ2U7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDkucHJldiA9IDA7CiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gTW9yYWxpcy5lbmFibGVXZWIzKCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldENoYWluSWQoKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgY2hhaW5JZE5ldFdvcmsgPSBfY29udGV4dDkuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoIShiYXNlQ3VycmVuY3kgPT09ICdFVEgnICYmIGNoYWluSWROZXRXb3JrICE9PSBwcm9jZXNzLmVudi5WVUVfQVBQX0NIQUlOX0VUSCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gY2hhaW5JZCA9IHByb2Nlc3MuZW52LlZVRV9BUFBfQ0hBSU5fRVRIIGFzIHN0cmluZwogICAgICAgICAgICAgICAgLy8gYXdhaXQgTW9yYWxpcy5zd2l0Y2hOZXR3b3JrKGNoYWluSWQpCiAgICAgICAgICAgICAgICAvLyByZXR1cm4KICAgICAgICAgICAgICAgIG5ldHdvcmtOYW1lID0gcHJvY2Vzcy5lbnYuVlVFX0FQUF9TV0lUQ0hfTkVUV09SS19OQU1FX0VUSDsKICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSB0aGlzLiR0KCdub3RpZnlfc3dpdGNoLW5ldHdvcmsnLCB7CiAgICAgICAgICAgICAgICAgIG5ldHdvcms6IG5ldHdvcmtOYW1lCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoewogICAgICAgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLAogICAgICAgICAgICAgICAgICBkdXJhdGlvbjogNTAwMAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIiwgUHJvbWlzZS5yZWplY3QoewogICAgICAgICAgICAgICAgICBjb2RlOiA1ODg4CiAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBpZiAoIShiYXNlQ3VycmVuY3kgPT09ICdCTkInICYmIGNoYWluSWROZXRXb3JrICE9PSBwcm9jZXNzLmVudi5WVUVfQVBQX0NIQUlOX0JOQikpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ5Lm5leHQgPSAxNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gY2hhaW5JZCA9IHByb2Nlc3MuZW52LlZVRV9BUFBfQ0hBSU5fQk5CIGFzIHN0cmluZwogICAgICAgICAgICAgICAgLy8gYXdhaXQgTW9yYWxpcy5zd2l0Y2hOZXR3b3JrKGNoYWluSWQpCiAgICAgICAgICAgICAgICAvLyByZXR1cm4KICAgICAgICAgICAgICAgIF9uZXR3b3JrTmFtZSA9IHByb2Nlc3MuZW52LlZVRV9BUFBfU1dJVENIX05FVFdPUktfTkFNRV9CTkI7CiAgICAgICAgICAgICAgICBfbWVzc2FnZSA9IHRoaXMuJHQoJ25vdGlmeV9zd2l0Y2gtbmV0d29yaycsIHsKICAgICAgICAgICAgICAgICAgbmV0d29yazogX25ldHdvcmtOYW1lCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoewogICAgICAgICAgICAgICAgICBtZXNzYWdlOiBfbWVzc2FnZSwKICAgICAgICAgICAgICAgICAgZHVyYXRpb246IDUwMDAKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIsIFByb21pc2UucmVqZWN0KHsKICAgICAgICAgICAgICAgICAgY29kZTogNTg4OAogICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIsIFByb21pc2UucmVzb2x2ZSgpKTsKCiAgICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5wcmV2ID0gMTk7CiAgICAgICAgICAgICAgICBfY29udGV4dDkudDAgPSBfY29udGV4dDlbImNhdGNoIl0oMCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhfY29udGV4dDkudDApOyAvLyBpZiAoZXJyb3IuY29kZSA9PT0gNDkwMikgewogICAgICAgICAgICAgICAgLy8gICAvL0B0cy1pZ25vcmUKICAgICAgICAgICAgICAgIC8vICAgYXdhaXQgd2luZG93LmV0aGVyZXVtLnJlcXVlc3QoewogICAgICAgICAgICAgICAgLy8gICAgIG1ldGhvZDogJ3dhbGxldF9hZGRFdGhlcmV1bUNoYWluJywKICAgICAgICAgICAgICAgIC8vICAgICBwYXJhbXM6IFsKICAgICAgICAgICAgICAgIC8vICAgICAgIHsKICAgICAgICAgICAgICAgIC8vICAgICAgICAgY2hhaW5JZDogJzB4NjEnLAogICAgICAgICAgICAgICAgLy8gICAgICAgICBjaGFpbk5hbWU6ICdCaW5hbmNlIFNtYXJ0IENoYWluIFRlc3RuZXQnLAogICAgICAgICAgICAgICAgLy8gICAgICAgICBuYXRpdmVDdXJyZW5jeTogewogICAgICAgICAgICAgICAgLy8gICAgICAgICAgIG5hbWU6ICdCTkInLAogICAgICAgICAgICAgICAgLy8gICAgICAgICAgIHN5bWJvbDogJ0JOQicsCiAgICAgICAgICAgICAgICAvLyAgICAgICAgICAgZGVjaW1hbHM6IDE4CiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHJwY1VybHM6IFsnaHR0cHM6Ly9kYXRhLXNlZWQtcHJlYnNjLTEtczEuYmluYW5jZS5vcmc6ODU0NSddLAogICAgICAgICAgICAgICAgLy8gICAgICAgICBibG9ja0V4cGxvcmVyVXJsczogWydodHRwczovL3Rlc3RuZXQuYnNjc2Nhbi5jb20nXQogICAgICAgICAgICAgICAgLy8gICAgICAgfQogICAgICAgICAgICAgICAgLy8gICAgIF0KICAgICAgICAgICAgICAgIC8vICAgfSkKICAgICAgICAgICAgICAgIC8vICAgYXdhaXQgdGhpcy5zd2l0Y2hOZXR3b3JrKGJhc2VDdXJyZW5jeSkKICAgICAgICAgICAgICAgIC8vIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIiwgUHJvbWlzZS5yZWplY3QoX2NvbnRleHQ5LnQwKSk7CgogICAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTksIHRoaXMsIFtbMCwgMTldXSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHN3aXRjaE5ldHdvcmsoX3gyOSkgewogICAgICAgIHJldHVybiBfc3dpdGNoTmV0d29yay5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gc3dpdGNoTmV0d29yazsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImdldENoYWluSWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRDaGFpbklkID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7CiAgICAgICAgdmFyIGNoYWluSWQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMCQoX2NvbnRleHQxMCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEwLnByZXYgPSBfY29udGV4dDEwLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDEwLnByZXYgPSAwOwogICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBNb3JhbGlzLmVuYWJsZVdlYjMoKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiBNb3JhbGlzLmNoYWluSWQ7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGNoYWluSWQgPSBfY29udGV4dDEwLnNlbnQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5hYnJ1cHQoInJldHVybiIsIFByb21pc2UucmVzb2x2ZShjaGFpbklkKSk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIF9jb250ZXh0MTAucHJldiA9IDk7CiAgICAgICAgICAgICAgICBfY29udGV4dDEwLnQwID0gX2NvbnRleHQxMFsiY2F0Y2giXSgwKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKF9jb250ZXh0MTAudDApOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuYWJydXB0KCJyZXR1cm4iLCBQcm9taXNlLnJlamVjdChfY29udGV4dDEwLnQwKSk7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEwLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMCwgbnVsbCwgW1swLCA5XV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRDaGFpbklkKCkgewogICAgICAgIHJldHVybiBfZ2V0Q2hhaW5JZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0Q2hhaW5JZDsKICAgIH0oKSAvLyBDb2RlIHBo4bqnbiB3YWxsZXQgY29ubmVjdCBtb2JpbGUKCiAgfSwgewogICAga2V5OiAiZW5hYmxlV2ViM1Byb3ZpZGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZW5hYmxlV2ViM1Byb3ZpZGVyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTEoKSB7CiAgICAgICAgdmFyIHByb3ZpZGVyOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTEkKF9jb250ZXh0MTEpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgLy8gIENyZWF0ZSBXYWxsZXRDb25uZWN0IFByb3ZpZGVyCiAgICAgICAgICAgICAgICBwcm92aWRlciA9IG5ldyBXYWxsZXRDb25uZWN0UHJvdmlkZXIoewogICAgICAgICAgICAgICAgICBycGM6IHsKICAgICAgICAgICAgICAgICAgICA5NzogJ2h0dHBzOi8vbmQtNDA2LTg4MS01NTEucDJwaWZ5LmNvbS8zMTUxMjllMjhkMTg1ODM5Nzc1M2FiMmMwNmUyM2ZjNScsCiAgICAgICAgICAgICAgICAgICAgMzogJ2h0dHBzOi8vbmQtOTEwLTk4MS0wODkucDJwaWZ5LmNvbS9iY2EzNWZiMjZlYThhNzk3MmU4YmU2NDRiYzhmNmUyNicKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgLy8gaW5mdXJhSWQ6ICc5YWEzZDk1YjNiYzQ0MGZhODhlYTEyZWFhNDQ1NjE2MScsCiAgICAgICAgICAgICAgICAgIHFyY29kZU1vZGFsT3B0aW9uczogewogICAgICAgICAgICAgICAgICAgIC8vIG1vYmlsZUxpbmtzOiBbJ3JhaW5ib3cnLCAnbWV0YW1hc2snLCAnYXJnZW50JywgJ3RydXN0JywgJ2ltdG9rZW4nLCAncGlsbGFyJ10KICAgICAgICAgICAgICAgICAgICBtb2JpbGVMaW5rczogWydtZXRhbWFzayddCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuYWJydXB0KCJyZXR1cm4iLCBwcm92aWRlcik7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTExKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZW5hYmxlV2ViM1Byb3ZpZGVyKCkgewogICAgICAgIHJldHVybiBfZW5hYmxlV2ViM1Byb3ZpZGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBlbmFibGVXZWIzUHJvdmlkZXI7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJhdXRvQ29ubmVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2F1dG9Db25uZWN0ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTIoKSB7CiAgICAgICAgdmFyIGlzV2FsbGV0Q29ubmVjdCwgcHJvdmlkZXIsIHdlYjMsIGFjY291bnQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMiQoX2NvbnRleHQxMikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDEyLnByZXYgPSAwOwogICAgICAgICAgICAgICAgaXNXYWxsZXRDb25uZWN0ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3dhbGxldGNvbm5lY3QnKTsKCiAgICAgICAgICAgICAgICBpZiAoIWlzV2FsbGV0Q29ubmVjdCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmVuYWJsZVdlYjNQcm92aWRlcigpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBwcm92aWRlciA9IF9jb250ZXh0MTIuc2VudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDg7CiAgICAgICAgICAgICAgICByZXR1cm4gcHJvdmlkZXIuZW5hYmxlKCk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIC8vQHRzLWlnbm9yZQogICAgICAgICAgICAgICAgd2ViMyA9IG5ldyBXZWIzKHByb3ZpZGVyKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDExOwogICAgICAgICAgICAgICAgcmV0dXJuIHdlYjMuZXRoLmdldEFjY291bnRzKCk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBhY2NvdW50ID0gX2NvbnRleHQxMi5zZW50OwogICAgICAgICAgICAgICAgdGhpcy5zZXRXYWxsZXRBZGRyZXNzKGFjY291bnRbMF0pOwogICAgICAgICAgICAgICAgdGhpcy5zZXRQcm92aWRlcldhbGxldENvbm5lY3QocHJvdmlkZXIpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gMTk7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTIucHJldiA9IDE2OwogICAgICAgICAgICAgICAgX2NvbnRleHQxMi50MCA9IF9jb250ZXh0MTJbImNhdGNoIl0oMCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhfY29udGV4dDEyLnQwKTsKCiAgICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEyLCB0aGlzLCBbWzAsIDE2XV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBhdXRvQ29ubmVjdCgpIHsKICAgICAgICByZXR1cm4gX2F1dG9Db25uZWN0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBhdXRvQ29ubmVjdDsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImRpc2Nvbm5lY3RXYyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2Rpc2Nvbm5lY3RXYyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTEzKCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTMkKF9jb250ZXh0MTMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMy5wcmV2ID0gX2NvbnRleHQxMy5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQxMy5wcmV2ID0gMDsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTMubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wcm92aWRlcldjLmRpc2Nvbm5lY3QoKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Rpc2Nvbm5lY3QnKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLmFicnVwdCgicmV0dXJuIiwgUHJvbWlzZS5yZXNvbHZlKCkpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBfY29udGV4dDEzLnByZXYgPSA3OwogICAgICAgICAgICAgICAgX2NvbnRleHQxMy50MCA9IF9jb250ZXh0MTNbImNhdGNoIl0oMCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhfY29udGV4dDEzLnQwKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEzLCB0aGlzLCBbWzAsIDddXSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGRpc2Nvbm5lY3RXYygpIHsKICAgICAgICByZXR1cm4gX2Rpc2Nvbm5lY3RXYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZGlzY29ubmVjdFdjOwogICAgfSgpCiAgfV0pOwoKICByZXR1cm4gT25DaGFpbk1peGluOwp9KE1peGlucyhQb3B1cE1peGluKSk7CgpfX2RlY29yYXRlKFtiY0F1dGguQWN0aW9uKCdzZXRUb2tlbkV4dGVybmFsTG9naW4nKV0sIE9uQ2hhaW5NaXhpbi5wcm90b3R5cGUsICJzZXRUb2tlbkV4dGVybmFsTG9naW4iLCB2b2lkIDApOwoKX19kZWNvcmF0ZShbYmNBdXRoLkFjdGlvbignc2V0VG9rZW5FeHRlcm5hbExvZ2luTW9iaWxlJyldLCBPbkNoYWluTWl4aW4ucHJvdG90eXBlLCAic2V0VG9rZW5FeHRlcm5hbExvZ2luTW9iaWxlIiwgdm9pZCAwKTsKCl9fZGVjb3JhdGUoW2JjQXV0aC5HZXR0ZXIoJ2lzTG9naW4nKV0sIE9uQ2hhaW5NaXhpbi5wcm90b3R5cGUsICJpc0xvZ2luIiwgdm9pZCAwKTsKCl9fZGVjb3JhdGUoW2JjQXV0aC5NdXRhdGlvbignU0VUX1dBTExFVF9BRERSRVNTJyldLCBPbkNoYWluTWl4aW4ucHJvdG90eXBlLCAic2V0V2FsbGV0QWRkcmVzcyIsIHZvaWQgMCk7CgpfX2RlY29yYXRlKFtiY05mdC5BY3Rpb24oJ3NldEluZm9BY3Rpdml0eScpXSwgT25DaGFpbk1peGluLnByb3RvdHlwZSwgInNldEluZm9BY3Rpdml0eSIsIHZvaWQgMCk7CgpfX2RlY29yYXRlKFtiY0F1dGguU3RhdGUoJ3dhbGxldEFkZHJlc3MnKV0sIE9uQ2hhaW5NaXhpbi5wcm90b3R5cGUsICJ3YWxsZXRBZGRyZXNzIiwgdm9pZCAwKTsKCl9fZGVjb3JhdGUoW2JjQXV0aC5TdGF0ZSgndXNlcicpXSwgT25DaGFpbk1peGluLnByb3RvdHlwZSwgInVzZXIiLCB2b2lkIDApOwoKX19kZWNvcmF0ZShbYmNOZnQuU3RhdGUoJ2xpc3ROZnRBc3NldCcpXSwgT25DaGFpbk1peGluLnByb3RvdHlwZSwgImxpc3ROZnRBc3NldE9uQ2hhaW4iLCB2b2lkIDApOwoKX19kZWNvcmF0ZShbYmNOZnQuU3RhdGUoJ3N0YXR1c0FwcHJvdmVBY2NvdW50JyldLCBPbkNoYWluTWl4aW4ucHJvdG90eXBlLCAic3RhdHVzQXBwcm92ZUFjY291bnQiLCB2b2lkIDApOwoKX19kZWNvcmF0ZShbYmNOZnQuTXV0YXRpb24oJ1NFVF9UWVBFX09GX0FDVElPTicpXSwgT25DaGFpbk1peGluLnByb3RvdHlwZSwgInNldFR5cGVPZkFjdGlvbiIsIHZvaWQgMCk7CgpfX2RlY29yYXRlKFtiY05mdC5TdGF0ZSgnbGlzdEFzc2V0TmV0d29yaycpXSwgT25DaGFpbk1peGluLnByb3RvdHlwZSwgImxpc3RBc3NldE5ldHdvcmsiLCB2b2lkIDApOwoKX19kZWNvcmF0ZShbYmNOZnQuU3RhdGUoJ2N1cnJlbmN5U2VsZWN0QnV5JyldLCBPbkNoYWluTWl4aW4ucHJvdG90eXBlLCAiY3VycmVuY3lTZWxlY3RCdXkiLCB2b2lkIDApOwoKX19kZWNvcmF0ZShbYmNOZnQuTXV0YXRpb24oJ1NFVF9JU19BTFJFQURZX0FQUFJPVkUnKV0sIE9uQ2hhaW5NaXhpbi5wcm90b3R5cGUsICJzZXRTdGF0dXNBbHJlYWR5QXBwcm92ZSIsIHZvaWQgMCk7CgpfX2RlY29yYXRlKFtiY05mdC5NdXRhdGlvbignU0VUX1NUQVRVU19BUFBST1ZFX0lURU0nKV0sIE9uQ2hhaW5NaXhpbi5wcm90b3R5cGUsICJzZXRTdGF0dXNBcHByb3ZlSXRlbSIsIHZvaWQgMCk7CgpfX2RlY29yYXRlKFtiY05mdC5NdXRhdGlvbignU0VUX1RSQU5TQUNUSU9OX0NPREVfSVRFTScpXSwgT25DaGFpbk1peGluLnByb3RvdHlwZSwgInNldFRyYW5zYWN0aW9uQ29kZUl0ZW0iLCB2b2lkIDApOwoKX19kZWNvcmF0ZShbYmNOZnQuU3RhdGUoJ2xpc3RBY2NlcHRDdXJyZW5jeScpXSwgT25DaGFpbk1peGluLnByb3RvdHlwZSwgImxpc3RBY2NlcHRDdXJyZW5jeSIsIHZvaWQgMCk7CgpfX2RlY29yYXRlKFtiY05mdC5TdGF0ZSgnbGlzdEFjY2VwdEN1cnJlbmN5QnV5JyldLCBPbkNoYWluTWl4aW4ucHJvdG90eXBlLCAibGlzdEFjY2VwdEN1cnJlbmN5QnV5Iiwgdm9pZCAwKTsKCl9fZGVjb3JhdGUoW2JjTmZ0LlN0YXRlKCd0b2tlbk5lZWRHZXRCYWxhbmNlJyldLCBPbkNoYWluTWl4aW4ucHJvdG90eXBlLCAidG9rZW5OZWVkR2V0QmFsYW5jZSIsIHZvaWQgMCk7CgpfX2RlY29yYXRlKFtiY05mdC5TdGF0ZSgnaXNEZXNrdG9wJyldLCBPbkNoYWluTWl4aW4ucHJvdG90eXBlLCAiaXNEZXNrdG9wIiwgdm9pZCAwKTsKCl9fZGVjb3JhdGUoW2JjTmZ0LlN0YXRlKCdwcm92aWRlcldjJyldLCBPbkNoYWluTWl4aW4ucHJvdG90eXBlLCAicHJvdmlkZXJXYyIsIHZvaWQgMCk7CgpfX2RlY29yYXRlKFtiY05mdC5NdXRhdGlvbignU0VUX1BST1ZJREVSX1dBTExFVF9DT05ORUNUJyldLCBPbkNoYWluTWl4aW4ucHJvdG90eXBlLCAic2V0UHJvdmlkZXJXYWxsZXRDb25uZWN0Iiwgdm9pZCAwKTsKCl9fZGVjb3JhdGUoW2JjTmZ0LlN0YXRlKCdpc0FscmVhZHlBcHByb3ZlJyldLCBPbkNoYWluTWl4aW4ucHJvdG90eXBlLCAiaXNBbHJlYWR5QXBwcm92ZSIsIHZvaWQgMCk7CgpfX2RlY29yYXRlKFtiZUJhc2UuU3RhdGUoJ2NvaW5NYWluJyldLCBPbkNoYWluTWl4aW4ucHJvdG90eXBlLCAiY29pbk1haW4iLCB2b2lkIDApOwoKX19kZWNvcmF0ZShbYmNBdXRoLkdldHRlcignaXNTaG93Q2hlY2tib3hBY2NlcHQnKV0sIE9uQ2hhaW5NaXhpbi5wcm90b3R5cGUsICJpc1Nob3dDaGVja2JveEFjY2VwdCIsIHZvaWQgMCk7CgpPbkNoYWluTWl4aW4gPSBfX2RlY29yYXRlKFtDb21wb25lbnQoewogIGNvbXBvbmVudHM6IHt9Cn0pXSwgT25DaGFpbk1peGluKTsKZXhwb3J0IGRlZmF1bHQgT25DaGFpbk1peGluOw=="},null]}