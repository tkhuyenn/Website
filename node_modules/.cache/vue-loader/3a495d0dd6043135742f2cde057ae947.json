{"remainingRequest":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\NEU\\CDTT\\frontend\\Website\\src\\modules\\setting\\components\\popup\\PopupVerifyPhone.vue?vue&type=style&index=0&id=ed574756&scoped=true&lang=scss&","dependencies":[{"path":"D:\\NEU\\CDTT\\frontend\\Website\\src\\modules\\setting\\components\\popup\\PopupVerifyPhone.vue","mtime":1660123011576},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\css-loader\\dist\\cjs.js","mtime":1660970368992},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1660970411845},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\postcss-loader\\src\\index.js","mtime":1660970387688},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1660970364303},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660970364629},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\vue-loader\\lib\\index.js","mtime":1660970394220}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmJ0biB7CiAgcGFkZGluZzogMTJweCAwICFpbXBvcnRhbnQ7CiAgZm9udC1zaXplOiAxNnB4ICFpbXBvcnRhbnQ7CiAgbGluZS1oZWlnaHQ6IDI0cHggIWltcG9ydGFudDsKfQoudGl0bGUtZm9ybSB7CiAgY29sb3I6ICMyMDFmMWU7CiAgbWFyZ2luLWJvdHRvbTogM3B4OwogIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7Cn0KLmlucHV0LWNvZGUgewogIG1hcmdpbi10b3A6IDE3cHg7Cn0KLmJ0bi1zdWJtaXQgewogIG1hcmdpbi1ib3R0b206IDI0cHg7Cn0KLnRleHQtZGlzY3JpcHQgewogIG1hcmdpbi10b3A6IDBweCAhaW1wb3J0YW50Owp9Ci5idG4tdGhlbWUgewogIGJhY2tncm91bmQ6IHZhcigtLWJjLXRhYi1hY3RpdmUpOwogIGNvbG9yOiAjZmZmOwp9Ci5idG4tdGhlbWU6aG92ZXIgewogIGJvcmRlcjogbm9uZTsKICBjb2xvcjogdmFyKC0tYmMtY29sb3Itd2hpdGUpOwogIGJhY2tncm91bmQ6IHZhcigtLWJjLXRoZW1lLXByaW1hcnktZ3JhZGllbnQtaG92ZXIpOwp9CkBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDc2OHB4KSB7CiAgOjp2LWRlZXAucG9wdXAtdmVyaWZ5ewogICAgLmVsLWRpYWxvZ3sKICAgICAgd2lkdGg6IDMzNXB4ICFpbXBvcnRhbnQ7CiAgICAgICZfX2hlYWRlcnsKICAgICAgICAudGl0bGV7CiAgICAgICAgICBmb250LXdlaWdodDogNjAwOwogICAgICAgICAgZm9udC1zaXplOiAxNnB4OwogICAgICAgICAgbGluZS1oZWlnaHQ6IDI0cHg7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["PopupVerifyPhone.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PopupVerifyPhone.vue","sourceRoot":"src/modules/setting/components/popup","sourcesContent":["<template>\r\n  <base-popup name=\"popup-verify-phone\" class=\"popup-verify\" width=\"480px\" :open=\"handleOpen\" :close=\"handleClose\" :isShowFooter=\"false\">\r\n    <div slot=\"title\">\r\n      <span>{{ $t('popup.title.verification') }}</span>\r\n    </div>\r\n    <div class=\"content\">\r\n      <h3 class=\"text-2xl text-center text-semibold title-form\">{{ $t('verified.titleContent2') }}</h3>\r\n      <div class=\"be-flex verify-code\">\r\n        <base-icon icon=\"verify-phone\" size=\"80\"></base-icon>\r\n        <div class=\"ml-1 w-100 input-code\">\r\n          <el-form :model=\"form\" :rules=\"rules\" ref=\"form-verify\" @submit.prevent.native=\"handleSubmit\">\r\n            <el-form-item prop=\"verificationCode\" :label=\"`${$t('verify.label')}`\" class=\"no-require-label\">\r\n              <el-input type=\"text\" v-model.trim=\"form.verificationCode\" maxlength=\"6\" :placeholder=\"`${$t('verify.placeholder')}`\" />\r\n            </el-form-item>\r\n          </el-form>\r\n        </div>\r\n      </div>\r\n      <el-button :loading=\"isLoading\" class=\"btn w-100 is-none-border cursor btn-submit btn-theme\" @click=\"handleSubmit\">{{ $t('verify.submit') }} </el-button>\r\n      <div class=\"text-base be-flex jc-space-center mt-24 mb-24 text-grey-130 text-discript\">\r\n        {{ $t('verify.question') }} &nbsp;<span class=\"text-hyperlink text-semibold cursor\" @click=\"handleResendCode\"> {{ $t('verify.re-send') }} </span>\r\n      </div>\r\n    </div>\r\n  </base-popup>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\n  import { Component, Mixins, Prop, Watch } from 'vue-property-decorator'\r\n  import PopupMixin from '@/mixins/popup'\r\n\r\n  import getRepository from '@/services'\r\n\r\n  import debounce from 'lodash/debounce'\r\n  import includes from 'lodash/includes'\r\n  import { SettingRepository } from '@/services/repositories/setting'\r\n\r\n  const apiSetting: SettingRepository = getRepository('setting')\r\n\r\n  @Component\r\n  export default class PopupVerifyPhone extends Mixins(PopupMixin) {\r\n    @Prop({ required: true, type: Object, default: () => ({}) }) data!: Record<string, any>\r\n    form: Record<string, any> = {\r\n      verificationCode: ''\r\n    }\r\n    isLoading = false\r\n    success: any = 0\r\n    rules: Record<string, any> = {\r\n      verificationCode: [\r\n        {\r\n          required: true,\r\n          message: this.$t('verify.wrong-code'),\r\n          trigger: 'blur'\r\n        },\r\n        {\r\n          len: 6,\r\n          message: this.$t('changePassword.errorLengthVerificationCode'),\r\n          trigger: 'blur'\r\n        }\r\n      ]\r\n    }\r\n    get getDisableBtn(): boolean {\r\n      return this.form.verificationCode.length !== 6\r\n    }\r\n\r\n    get getIcon(): string {\r\n      const name = this.$route.name\r\n      if (name === 'verify-phone') {\r\n        return 'verify-phone'\r\n      }\r\n      if (name === 'verify-email') {\r\n        return 'verify-email'\r\n      }\r\n      return 'verify-app'\r\n    }\r\n\r\n    @Watch('form.verificationCode') watchCode(code: string): void {\r\n      if (code) {\r\n        //@ts-ignore\r\n        this.$refs['form-verify']?.clearValidate()\r\n      }\r\n    }\r\n\r\n    // get getTittle(): string | any {\r\n    //   const name = this.$route.name\r\n    //   if (name === 'verify-phone') {\r\n    //     return this.$t('verify.title-phone')\r\n    //   }\r\n    //   if (name === 'verify-email') {\r\n    //     return this.$t('verify.title-email')\r\n    //   }\r\n    //   return this.$t('verify.title-app')\r\n    // }\r\n    // debounce chan doble click\r\n    debounceFilter = debounce((nameAction: any) => {\r\n      if (nameAction == 'handleResendCode') {\r\n        this.resendCode()\r\n      }\r\n      if (nameAction == 'handleSubmit') {\r\n        this.submit()\r\n      }\r\n    }, 400)\r\n    handleResendCode(): void {\r\n      this.debounceFilter('handleResendCode')\r\n    }\r\n    async resendCode(): Promise<void> {\r\n      let message: any = ''\r\n      apiSetting\r\n        .changePhone(this.data, { resendCode: 'new' })\r\n        .then(() => {\r\n          message = this.$t('notify.send-code')\r\n          this.$message.success({ message, duration: 5000 })\r\n        })\r\n        .catch(error => {\r\n          let message: any = ''\r\n          const { config, data } = error.response\r\n\r\n          if (data.status === 'USER_BLOCKED' && includes(config.url, 'resendCode')) {\r\n            message = this.$t('notify.user-blocked-resend-code')\r\n            this.$message.error({ message, duration: 5000 })\r\n          }\r\n          if (data.status === 'USER_LOCKED' && includes(config.url, 'resendCode')) {\r\n            message = this.$t('notify.user-locked-resend-code')\r\n            this.$message.error({ message, duration: 5000 })\r\n          }\r\n        })\r\n    }\r\n    handleReset(): void {\r\n      this.form = {\r\n        verificationCode: ''\r\n      }\r\n      this.success = 0\r\n    }\r\n    handleClose(): void {\r\n      //@ts-ignore\r\n      this.$refs['form-verify'].clearValidate()\r\n      this.handleReset()\r\n    }\r\n    handleOpen(): void {\r\n      console.log('open')\r\n    }\r\n    handleSubmit(): void {\r\n      this.debounceFilter('handleSubmit')\r\n    }\r\n    async submit(): Promise<void> {\r\n      //@ts-ignore\r\n      this.$refs['form-verify']?.validate(async valid => {\r\n        if (valid) {\r\n          this.isLoading = true\r\n          const data = {\r\n            ...this.data,\r\n            verificationCodeOldPhone: null,\r\n            verificationCodeNewPhone: this.form.verificationCode\r\n          }\r\n          apiSetting\r\n            .changePhoneVerification(data)\r\n            .then(() => {\r\n              let message: any = ''\r\n              message = this.$t('notify.verify-success')\r\n              this.$message.success({ message, duration: 5000 })\r\n              this.setOpenPopup({\r\n                popupName: 'popup-verify-phone',\r\n                isOpen: false\r\n              })\r\n              this.$emit('reload')\r\n            })\r\n            .catch(() => {\r\n              this.isLoading = false\r\n            })\r\n        }\r\n      })\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n  .btn {\r\n    padding: 12px 0 !important;\r\n    font-size: 16px !important;\r\n    line-height: 24px !important;\r\n  }\r\n  .title-form {\r\n    color: #201f1e;\r\n    margin-bottom: 3px;\r\n    word-break: break-word;\r\n  }\r\n  .input-code {\r\n    margin-top: 17px;\r\n  }\r\n  .btn-submit {\r\n    margin-bottom: 24px;\r\n  }\r\n  .text-discript {\r\n    margin-top: 0px !important;\r\n  }\r\n  .btn-theme {\r\n    background: var(--bc-tab-active);\r\n    color: #fff;\r\n  }\r\n  .btn-theme:hover {\r\n    border: none;\r\n    color: var(--bc-color-white);\r\n    background: var(--bc-theme-primary-gradient-hover);\r\n  }\r\n  @media screen and (max-width: 768px) {\r\n    ::v-deep.popup-verify{\r\n      .el-dialog{\r\n        width: 335px !important;\r\n        &__header{\r\n          .title{\r\n            font-weight: 600;\r\n            font-size: 16px;\r\n            line-height: 24px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n</style>\r\n"]}]}