{"remainingRequest":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\NEU\\CDTT\\frontend\\Website\\src\\modules\\setting\\components\\popup\\PopupForgotPin.vue?vue&type=script&lang=ts&","dependencies":[{"path":"D:\\NEU\\CDTT\\frontend\\Website\\src\\modules\\setting\\components\\popup\\PopupForgotPin.vue","mtime":1660123011574},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660970364629},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\babel-loader\\lib\\index.js","mtime":1660970387821},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\ts-loader\\index.js","mtime":1660970390648},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1660970364629},{"path":"D:\\NEU\\CDTT\\frontend\\Website\\node_modules\\vue-loader\\lib\\index.js","mtime":1660970394220}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7IENvbXBvbmVudCwgTWl4aW5zLCBQcm9wLCBXYXRjaCB9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InCmltcG9ydCBQb3B1cE1peGluIGZyb20gJ0AvbWl4aW5zL3BvcHVwJwppbXBvcnQgZ2V0UmVwb3NpdG9yeSBmcm9tICdAL3NlcnZpY2VzJwppbXBvcnQgeyBTZXR0aW5nUmVwb3NpdG9yeSB9IGZyb20gJ0Avc2VydmljZXMvcmVwb3NpdG9yaWVzL3NldHRpbmcnCmltcG9ydCBkZWJvdW5jZSBmcm9tICdsb2Rhc2gvZGVib3VuY2UnCmNvbnN0IGFwaTogU2V0dGluZ1JlcG9zaXRvcnkgPSBnZXRSZXBvc2l0b3J5KCdzZXR0aW5nJykKQENvbXBvbmVudCh7IGNvbXBvbmVudHM6IHt9IH0pCmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwRm9yZ290UGluIGV4dGVuZHMgTWl4aW5zKFBvcHVwTWl4aW4pIHsKICBAUHJvcCgpIGRhdGFDb2RlITogc3RyaW5nCiAgQFByb3AoKSB0aXRsZSE6IHN0cmluZwogIEBQcm9wKCkgdmFsdWVQaW4hOiBib29sZWFuCiAgZm9ybTogUmVjb3JkPHN0cmluZywgYW55PiA9IHsKICAgIHBpbjogJycsCiAgICBjb25maXJtUGluOiAnJywKICAgIHZlcmlmaWNhdGlvbkNvZGU6ICcnLAogICAgcGluRW5hYmxlZDogMSwKICAgIHR5cGU6ICdFTUFJTCcKICB9CiAgZXJyb3IgPSBmYWxzZQogIHJ1bGVzOiBhbnkgPSB7CiAgICBwaW46IFsKICAgICAgewogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ2ZvcmdvdFBpbi53cm9uZy1uZXdQaW4nKSwKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfSwKICAgICAgewogICAgICAgIGxlbjogNCwKICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCdmb3Jnb3RQaW4uZXJyb3ItbGVuZ3RoJyksCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0KICAgIF0sCiAgICBjb25maXJtUGluOiBbCiAgICAgIHsKICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCdmb3Jnb3RQaW4ud3JvbmctY29uZmlybVBpbicpLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9LAogICAgICB7CiAgICAgICAgbGVuOiA0LAogICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ2ZvcmdvdFBpbi5lcnJvci1sZW5ndGgnKSwKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfQogICAgXSwKICAgIHZlcmlmaWNhdGlvbkNvZGU6IFsKICAgICAgewogICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ2ZvcmdvdFBpbi53cm9uZy1jb2RlJyksCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBsZW46IDYsCiAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgnY2hhbmdlUGFzc3dvcmQuZXJyb3JMZW5ndGhWZXJpZmljYXRpb25Db2RlJyksCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0KICAgIF0KICB9CiAgbmV4dFZhbHVlUGluID0gMAogIEBXYXRjaCgnZm9ybS5jb25maXJtUGluJykgd2F0Y2hDb25maXJtUGFzc3dvcmQocGFzczogc3RyaW5nKTogdm9pZCB7CiAgICBpZiAocGFzcy5sZW5ndGggPiAwICYmIHRoaXMuZm9ybS5waW4gIT09IHBhc3MpIHsKICAgICAgdGhpcy5lcnJvciA9IHRydWUKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZXJyb3IgPSBmYWxzZQogICAgfQogIH0KICBoYW5kbGVSZXNldCgpOiB2b2lkIHsKICAgIHRoaXMuZm9ybSA9IHsKICAgICAgcGluOiAnJywKICAgICAgY29uZmlybVBpbjogJycsCiAgICAgIHZlcmlmaWNhdGlvbkNvZGU6ICcnLAogICAgICBwaW5FbmFibGVkOiAxLAogICAgICB0eXBlOiAnRU1BSUwnCiAgICB9CiAgICB0aGlzLmVycm9yID0gZmFsc2UKICAgIGlmICh0aGlzLiRyZWZzLmZvcmdvdFBpbikgewogICAgICAvL0B0cy1pZ25vcmUKICAgICAgdGhpcy4kcmVmcy5mb3Jnb3RQaW4uY2xlYXJWYWxpZGF0ZSgpCiAgICB9CiAgfQoKICBoYW5kbGVDYW5jZWwoKTogdm9pZCB7CiAgICB0aGlzLnNldE9wZW5Qb3B1cCh7CiAgICAgIHBvcHVwTmFtZTogJ3BvcHVwLWZvcmdvdC1waW4nLAogICAgICBpc09wZW46IGZhbHNlCiAgICB9KQogIH0KICBoYW5kbGVDbG9zZSgpOiB2b2lkIHsKICAgIHRoaXMuaGFuZGxlUmVzZXQoKQogICAgaWYgKHRoaXMubmV4dFZhbHVlUGluID09IDApIHsKICAgICAgdGhpcy4kZW1pdCgncmVsb2FkVmFsdWVQaW4nLCAhdGhpcy52YWx1ZVBpbikKICAgIH0KICB9CiAgdmFsaWRhdGVGb3JtKCk6IGJvb2xlYW4gewogICAgbGV0IGZvcmdvdFBpbjogYW55ID0gdGhpcy4kcmVmcy5mb3Jnb3RQaW4KICAgIGxldCB2YWxpZCA9IGZhbHNlCiAgICBmb3Jnb3RQaW4udmFsaWRhdGUoKF92YWxpZDogYm9vbGVhbikgPT4gewogICAgICB2YWxpZCA9IF92YWxpZAogICAgfSkKICAgIHJldHVybiB2YWxpZAogIH0KICAvLyBkZWJvdW5jZSBjaGFuIGRvYmxlIGNsaWNrCiAgZGVib3VuY2VGaWx0ZXIgPSBkZWJvdW5jZSgobmFtZUFjdGlvbjogYW55KSA9PiB7CiAgICBpZiAobmFtZUFjdGlvbiA9PSAnaGFuZGxlU3VibWl0JykgewogICAgICB0aGlzLnN1Ym1pdCgpCiAgICB9CiAgfSwgNDAwKQogIGFzeW5jIGhhbmRsZVN1Ym1pdCgpOiBQcm9taXNlPHZvaWQ+IHsKICAgIGNvbnN0IHZhbGlkID0gdGhpcy52YWxpZGF0ZUZvcm0oKQogICAgdGhpcy5mb3JtLnZlcmlmaWNhdGlvbkNvZGUgPSB0aGlzLmRhdGFDb2RlCiAgICBpZiAodmFsaWQgJiYgIXRoaXMuZXJyb3IpIHsKICAgICAgdGhpcy5kZWJvdW5jZUZpbHRlcignaGFuZGxlU3VibWl0JykKICAgIH0KICB9CiAgYXN5bmMgc3VibWl0KCk6IFByb21pc2U8dm9pZD4gewogICAgY29uc3QgcGluID0gdGhpcy4kb3B0aW9ucy5maWx0ZXJzPy5lbmNyeXB0UGFzc3dvcmQodGhpcy5mb3JtLnBpbikKICAgIGF3YWl0IGFwaQogICAgICAub25QaW4oeyAuLi50aGlzLmZvcm0sIHBpbjogcGluLCBjb25maXJtUGluOiAnJyB9KQogICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy5uZXh0VmFsdWVQaW4gPSAxCiAgICAgICAgbGV0IG1lc3NhZ2U6IGFueSA9IHRoaXMuJHQoJ2NoYW5nZVBpbi5jaGFuZ2VQaW5TdWNjZXNzJykKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MobWVzc2FnZSkKICAgICAgICB0aGlzLiRlbWl0KCdyZWxvYWRQaW4nKQogICAgICAgIHRoaXMuc2V0T3BlblBvcHVwKHsKICAgICAgICAgIHBvcHVwTmFtZTogJ3BvcHVwLWZvcmdvdC1waW4nLAogICAgICAgICAgaXNPcGVuOiBmYWxzZQogICAgICAgIH0pCiAgICAgIH0pCiAgICAgIC5jYXRjaCgoKSA9PiB7CiAgICAgICAgbGV0IG1lc3NhZ2U6IGFueSA9IHRoaXMuJHQoJ2NoYW5nZVBpbi5lcnJvck9sZFBpbicpCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihtZXNzYWdlKQogICAgICB9KQogIH0KICBudW1iZXJGb3JtYXQoZXZlbnQ6IEZvY3VzRXZlbnQpOiB2b2lkIHsKICAgIGNvbnN0IF9ldmVudDogYW55ID0gZXZlbnQKICAgIGxldCBmbnVtYmVyID0gX2V2ZW50LnRhcmdldC52YWx1ZQogICAgaWYgKCFpc05hTihmbnVtYmVyKSkgewogICAgICBfZXZlbnQudGFyZ2V0LnZhbHVlID0gZm51bWJlcgogICAgfSBlbHNlIHsKICAgICAgX2V2ZW50LnRhcmdldC52YWx1ZSA9ICcnCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["PopupForgotPin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PopupForgotPin.vue","sourceRoot":"src/modules/setting/components/popup","sourcesContent":["<template>\r\n  <base-popup name=\"popup-forgot-pin\" class=\"popup-forgot-pin\" :close=\"handleClose\" width=\"480px\">\r\n    <div slot=\"title\">\r\n      <span>{{ title ? $t('forgotPin.title2') : $t('forgotPin.title') }}</span>\r\n    </div>\r\n    <div class=\"content\">\r\n      <el-form class=\"form-forgot-pin\" ref=\"forgotPin\" :rules=\"rules\" :model=\"form\">\r\n        <div class=\"label label-top\">{{ $t('forgotPin.label1') }}</div>\r\n        <el-form-item prop=\"pin\" class=\"box-input\">\r\n          <el-input type=\"password\" v-model=\"form.pin\" :placeholder=\"$t('forgotPin.label1')\" maxlength=\"4\" @keyup.native=\"numberFormat($event)\"></el-input>\r\n        </el-form-item>\r\n        <div class=\"label\">{{ $t('forgotPin.label2') }}</div>\r\n        <el-form-item prop=\"confirmPin\" class=\"box-input\">\r\n          <el-input type=\"password\" v-model=\"form.confirmPin\" :placeholder=\"$t('forgotPin.label2')\" maxlength=\"4\" @keyup.native=\"numberFormat($event)\"></el-input>\r\n          <div v-if=\"error\" class=\"error\">{{ $t('forgotPin.errorPin') }}</div>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n    <div slot=\"footer\" class=\"footer\">\r\n      <div @click=\"handleCancel\" class=\"btn-action btn-close\">{{ $t('forgotPin.cancel') }}</div>\r\n      <div @click=\"handleSubmit\" class=\"btn-action btn-submit\">{{ title ? $t('forgotPin.reset2') : $t('forgotPin.reset') }}</div>\r\n    </div>\r\n  </base-popup>\r\n</template>\r\n<script lang=\"ts\">\r\n  import { Component, Mixins, Prop, Watch } from 'vue-property-decorator'\r\n  import PopupMixin from '@/mixins/popup'\r\n  import getRepository from '@/services'\r\n  import { SettingRepository } from '@/services/repositories/setting'\r\n  import debounce from 'lodash/debounce'\r\n  const api: SettingRepository = getRepository('setting')\r\n  @Component({ components: {} })\r\n  export default class PopupForgotPin extends Mixins(PopupMixin) {\r\n    @Prop() dataCode!: string\r\n    @Prop() title!: string\r\n    @Prop() valuePin!: boolean\r\n    form: Record<string, any> = {\r\n      pin: '',\r\n      confirmPin: '',\r\n      verificationCode: '',\r\n      pinEnabled: 1,\r\n      type: 'EMAIL'\r\n    }\r\n    error = false\r\n    rules: any = {\r\n      pin: [\r\n        {\r\n          required: true,\r\n          message: this.$t('forgotPin.wrong-newPin'),\r\n          trigger: 'blur'\r\n        },\r\n        {\r\n          len: 4,\r\n          message: this.$t('forgotPin.error-length'),\r\n          trigger: 'blur'\r\n        }\r\n      ],\r\n      confirmPin: [\r\n        {\r\n          required: true,\r\n          message: this.$t('forgotPin.wrong-confirmPin'),\r\n          trigger: 'blur'\r\n        },\r\n        {\r\n          len: 4,\r\n          message: this.$t('forgotPin.error-length'),\r\n          trigger: 'blur'\r\n        }\r\n      ],\r\n      verificationCode: [\r\n        {\r\n          required: true,\r\n          message: this.$t('forgotPin.wrong-code'),\r\n          trigger: 'blur'\r\n        },\r\n        {\r\n          len: 6,\r\n          message: this.$t('changePassword.errorLengthVerificationCode'),\r\n          trigger: 'blur'\r\n        }\r\n      ]\r\n    }\r\n    nextValuePin = 0\r\n    @Watch('form.confirmPin') watchConfirmPassword(pass: string): void {\r\n      if (pass.length > 0 && this.form.pin !== pass) {\r\n        this.error = true\r\n      } else {\r\n        this.error = false\r\n      }\r\n    }\r\n    handleReset(): void {\r\n      this.form = {\r\n        pin: '',\r\n        confirmPin: '',\r\n        verificationCode: '',\r\n        pinEnabled: 1,\r\n        type: 'EMAIL'\r\n      }\r\n      this.error = false\r\n      if (this.$refs.forgotPin) {\r\n        //@ts-ignore\r\n        this.$refs.forgotPin.clearValidate()\r\n      }\r\n    }\r\n\r\n    handleCancel(): void {\r\n      this.setOpenPopup({\r\n        popupName: 'popup-forgot-pin',\r\n        isOpen: false\r\n      })\r\n    }\r\n    handleClose(): void {\r\n      this.handleReset()\r\n      if (this.nextValuePin == 0) {\r\n        this.$emit('reloadValuePin', !this.valuePin)\r\n      }\r\n    }\r\n    validateForm(): boolean {\r\n      let forgotPin: any = this.$refs.forgotPin\r\n      let valid = false\r\n      forgotPin.validate((_valid: boolean) => {\r\n        valid = _valid\r\n      })\r\n      return valid\r\n    }\r\n    // debounce chan doble click\r\n    debounceFilter = debounce((nameAction: any) => {\r\n      if (nameAction == 'handleSubmit') {\r\n        this.submit()\r\n      }\r\n    }, 400)\r\n    async handleSubmit(): Promise<void> {\r\n      const valid = this.validateForm()\r\n      this.form.verificationCode = this.dataCode\r\n      if (valid && !this.error) {\r\n        this.debounceFilter('handleSubmit')\r\n      }\r\n    }\r\n    async submit(): Promise<void> {\r\n      const pin = this.$options.filters?.encryptPassword(this.form.pin)\r\n      await api\r\n        .onPin({ ...this.form, pin: pin, confirmPin: '' })\r\n        .then(() => {\r\n          this.nextValuePin = 1\r\n          let message: any = this.$t('changePin.changePinSuccess')\r\n          this.$message.success(message)\r\n          this.$emit('reloadPin')\r\n          this.setOpenPopup({\r\n            popupName: 'popup-forgot-pin',\r\n            isOpen: false\r\n          })\r\n        })\r\n        .catch(() => {\r\n          let message: any = this.$t('changePin.errorOldPin')\r\n          this.$message.error(message)\r\n        })\r\n    }\r\n    numberFormat(event: FocusEvent): void {\r\n      const _event: any = event\r\n      let fnumber = _event.target.value\r\n      if (!isNaN(fnumber)) {\r\n        _event.target.value = fnumber\r\n      } else {\r\n        _event.target.value = ''\r\n      }\r\n    }\r\n  }\r\n</script>\r\n<style scoped lang=\"scss\">\r\n  .popup-forgot-pin {\r\n    .content {\r\n      .error {\r\n        color: var(--bc-required);\r\n        font-size: 12px;\r\n        margin-top: -10px;\r\n      }\r\n      .label {\r\n        margin-top: 24px;\r\n        color: var(--bc-text-primary);\r\n        font-weight: 400;\r\n        font-size: 14px;\r\n      }\r\n      .label-top {\r\n        margin-top: 0px;\r\n      }\r\n      .box-input {\r\n        margin-top: 8px;\r\n        height: 48px;\r\n      }\r\n    }\r\n    .footer {\r\n      display: flex;\r\n      justify-content: flex-end;\r\n      align-items: center;\r\n      .btn-action {\r\n        width: 100px;\r\n        height: 40px;\r\n        text-align: center;\r\n        line-height: 40px;\r\n        font-size: 16px;\r\n        font-weight: 400;\r\n        cursor: pointer;\r\n        border-radius: 6px;\r\n        &:hover {\r\n          color: var(--bc-btn-default-text-hover);\r\n          border: 1px solid var(--bc-btn-default-border-hover);\r\n        }\r\n      }\r\n      .btn-close {\r\n        background: var(--bc-color-white);\r\n        border: 1px solid var(--bc-color-grey50);\r\n        color: var(--bc-color-grey150);\r\n        margin-right: 16px;\r\n        &:hover {\r\n          border-color: var(--bc-btn-default-border-hover);\r\n          background: var(--bc-btn-default-text-hover);\r\n          -webkit-background-clip: text;\r\n          -webkit-text-fill-color: transparent;\r\n        }\r\n      }\r\n      .btn-submit {\r\n        color: var(--bc-color-white);\r\n        background: var(--bc-theme-primary-gradient);\r\n        border: none;\r\n        &:hover {\r\n          border: none;\r\n          color: var(--bc-color-white);\r\n          background: var(--bc-theme-primary-gradient-hover) !important;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  @media screen and (max-width: 768px) {\r\n    ::v-deep.popup-forgot-pin{\r\n      .el-dialog{\r\n        width: 335px !important;\r\n        &__header{\r\n          .title{\r\n            font-weight: 600;\r\n            font-size: 16px;\r\n            line-height: 24px;\r\n          }\r\n        }\r\n        &__footer{\r\n          .popup-footer{\r\n            .btn-action{\r\n              display: flex;\r\n              align-items: center;\r\n              justify-content: center;\r\n              font-weight: 600;\r\n              font-size: 14px;\r\n              line-height: 20px;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n</style>\r\n"]}]}